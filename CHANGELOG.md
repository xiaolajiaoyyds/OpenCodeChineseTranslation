# 更新日志 / Changelog

本文档记录 OpenCode 中文汉化版的所有重要更改。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

---

## [7.3.0] - 2026-01-23

### 🚀 自动化增强

- **一键安装脚本** - 新增 `install.sh` (Linux/macOS) 和 `install.ps1` (Windows)，一行命令即可安装汉化工具
- **Release 日志增强** - 自动抓取 OpenCode 官方仓库最近 15 次提交记录，填充到 Release Notes 中
- **定时巡检** - GitHub Actions 增加定时任务 (每天 UTC 0点)，自动检查更新并构建，失败发送邮件报警

## [7.2.2] - 2026-01-22

### 📝 文档与发布优化

- **发布样式优化** - GitHub Release 标题现在包含完整的版本名称 (如 "OpenCode 中文汉化版 v7.2.2")
- **文档增强** - README 新增最新版本下载徽章和快捷链接，方便用户直接获取

## [7.2.1] - 2026-01-22

### 🐛 修复

- **版本号同步** - 修复打包脚本读取旧版本号导致发布失败的问题
- **统一版本源** - 确保所有工具统一从 `scripts/core/version.js` 读取版本

## [7.2.0] - 2026-01-22

### 🚀 自动化发布与缓存修复

- **清理缓存功能** - 主菜单新增 `[C] 清理缓存` 选项，解决 `bun install` 时的 EPERM 权限报错 (Fixes #3)
- **智能自动化发布** - 集成 GitHub Actions 自动化工作流，支持一键发布新版本
  - **自动三端构建** - 打 `v*` 标签时自动编译 Windows/macOS/Linux 二进制包
  - **汉化工具打包** - 自动打包 `opencode-i18n-tool.zip` (源码便携版)
  - **手动触发支持** - 支持手动触发发布，并可选择跳过耗时的二进制编译
- **提交规范** - 新增 `CONTRIBUTING.md` 贡献指南，规范化版本管理和代码提交

---

## [7.1.0] - 2026-01-21

### 🛠️ 环境修复与增强

- **Bun 版本校准** - 新增 Bun 版本自动检测与校准功能
- **Windows 兼容性修复** - 解决 Bun v1.3.6 在 Windows 下的 EPERM 权限错误 (Fixes #1)
- **智能交互** - 环境检查 (`env`) 和新菜单项 (`[B] 校准 Bun`) 支持一键自动降级到推荐版本

### 🎨 界面更新

- **状态栏增强** - 主菜单状态栏实时显示 Bun 版本状态（匹配/不匹配/未安装）
- **修复提示** - 版本不匹配时显示醒目的红色警告和推荐版本

---

## [7.0.0] - 2025-01-18 🎉 大版本更新

### 🎨 全新 TUI 界面

- **网格菜单布局** - 3 列网格布局，更直观的功能选择
- **键盘导航** - 支持 ↑↓←→ 方向键、1-9 数字快捷键、Q 快速退出
- **备用屏幕缓冲区** - 使用 ANSI 转义序列实现干净的全屏体验
- **终端居中显示** - 固定宽度 72 字符，自动居中适配各种终端宽度

### 🔄 异步更新检测

- **汉化脚本更新检测** - 通过 `git fetch` 异步检测是否有新版本
- **OpenCode 源码更新检测** - 实时检测上游是否有更新
- **动态状态刷新** - 检测完成后自动更新界面状态栏
- **清晰的状态显示** - 分别显示「汉化脚本最新」和「OpenCode最新」

### 🖥️ 三端兼容性

- **Windows 适配** - PowerShell 集成、PATH 环境变量管理
- **macOS 适配** - Apple Silicon 支持、.app 包创建
- **Linux 适配** - .desktop 快捷方式、shell 配置文件更新
- **统一平台抽象** - `platforms/` 目录提供跨平台 API

### ⚡ 体验优化

- **操作可见性** - 命令输出在主屏幕显示，不再被备用屏幕遮挡
- **优雅退出** - 选择退出后直接关闭，无需 Ctrl+C
- **状态一目了然** - 源码/汉化/编译状态实时显示
- **错误处理改进** - 更友好的错误提示和恢复建议

### 🔧 技术改进

- **`grid-menu.js`** - 全新的网格菜单模块
- **`menu.js` 重构** - 异步更新检测、状态管理优化
- **`utils.js` 修复** - `execLive` 函数三端兼容性修复
- **`windows.js` 修复** - `isInPath` 函数性能优化

---

## [6.0.0] - 2025-01-14

### 🚀 重大更新

- **统一 CLI 工具** - `opencodenpm` 命令取代原有 PowerShell 脚本
- **项目结构重构** - 移除 `-v2` 后缀，统一命名规范
- **Node.js 实现** - 从 PowerShell 迁移到 Node.js，提升跨平台兼容性

### 📦 新增功能

- `opencodenpm deploy` - 部署全局命令
- `opencodenpm package` - 打包三端发布版本
- `opencodenpm rollback` - 回滚到备份版本
- `opencodenpm helper` - 智谱编程助手集成

### 📝 文档

- 添加 Oh My OpenCode 完整使用指南
- 添加 Antigravity Tools 集成教程
- 添加 AI 维护指南

---

## [5.2] - 2026-01-10

### 修复
- 修复汉化配置破坏代码的问题（使用更精确的替换模式）
- 修复 dialog-help.json：`"Help"` → `"Help\n"`
- 修复 dialog-status.json：`"Status"` → `"Status\n"`
- 修复 route-sidebar.json：`"active"` → `"} active"`
- 移除过时的翻译配置项

### 安全增强
- 确保汉化不会破坏代码标识符
- 所有替换规则使用更精确的模式匹配

---

## [5.1] - 2026-01-10

### 新增
- 添加语言包版本适配检测功能
- 显示版本不匹配警告和维护者联系方式

### 修复
- 修复验证失败的2个模块配置（删除过时的替换项）

### 文档
- 添加版本适配说明和联系方式

---

## [5.0] - 2026-01-10

### 优化
- 优化文件标记速度：批量处理（500个文件/批）
- 添加配置加载和应用补丁的进度提示
- 简化应用补丁的输出格式

### 修复
- 修复 git fetch refspec 解析错误（使用 PowerShell 数组传递参数）

---

## [4.9] - 2026-01-10

### 修复
- 修复 git fetch refspec 解析错误（使用 PowerShell 数组传递参数）
- 修复字符串插值导致的 refspec 格式问题

---

## [4.8] - 2026-01-10

### 优化
- 优化代理检测：Clash 端口 7897/7898 优先检测
- 增加超时时间到 2 秒，提高检测成功率

---

## [4.7] - 2026-01-10

### 修复
- 修复批量处理参数过长问题（改为分批500个文件处理）
- 增加更多常见代理端口检测

---

## [4.6] - 2026-01-10

### 优化
- 文件忽略标记解除改为批量处理（2689个文件从分钟级降到秒级）
- git pull 改为指定分支拉取，避免多分支合并冲突

---

## [4.5] - 2026-01-09

### 新增
- 错误消息汉化：剪贴板复制失败提示
- 验证脚本新增字符串匹配测试

### 修复
- 修复验证脚本字符串匹配问题（使用 IndexOf 替代 -like）
- 修复模板字符串变量展开导致的匹配失败

### 文档
- 文档专业化重写，移除 AI 风格表达
- 新增系统兼容性详细说明
- 新增三种部署方式说明
- 新增代理自动检测说明

---

## [4.3] - 2026-01-08

### 新增
- 自动检测本地代理功能（支持 Clash、V2RayN、Surge 等）
- 版本检测页面新增"是否立即更新？"交互选项
- 主菜单新增 `[2] 应用汉化` 选项
- 主菜单新增 `[3] 验证汉化` 选项

### 优化
- 菜单结构优化，将常用功能提升至主菜单
- 高级菜单新增 `[4] 验证汉化` 选项

### 修复
- 修复 assume-unchanged 标记导致 Git Pull 无法更新文件的问题
- 修复版本检测后源码未更新问题
- 修复 Load-Modules 函数作用域问题（通过参数传递 hashtable）

---

## [4.0] - 2026-01-07

### 重构
- 配置文件模块化重构，将单一 JSON 拆分为 36 个独立模块
- 新增按类别组织的配置结构（dialogs、routes、components、common）
- 支持独立模块管理和测试

### 新增
- 模块化验证脚本，支持单独验证各模块
- 配置版本控制机制

---

## [3.1] - 2026-01-06

### 优化
- 菜单项重新排序，常用功能前置
- 改进版本检测输出格式

### 修复
- 修复版本检测显示错误问题
- 修复菜单选项对应关系

---

## [3.0] - 2026-01-05

### 新增
- 一键汉化+部署功能
- 交互式菜单系统
- 自动化拉取、汉化、编译、部署全流程

---

## [1.0] - 2025-12-01

### 初始版本
- 基础汉化配置
- 手动应用脚本
- 支持 OpenCode 基础功能中文化

---

## 版本说明

| 版本类型 | 说明 |
|----------|------|
| Major (主版本) | 架构重构、不兼容更改 |
| Minor (次版本) | 新增功能、模块扩展 |
| Patch (修订版) | Bug 修复、文档更新 |

---

## 路线图

### 计划中
- [ ] 支持更多第三方模型界面汉化
- [ ] 添加翻译贡献者系统
- [ ] 支持自定义翻译覆盖
- [ ] 添加 GUI 配置工具
- [ ] **TODO: 支持 AI 系统提示词 (System Prompts) 汉化**

---

## 链接

- [版本对比](https://github.com/1186258278/OpenCodeChineseTranslation/compare)
- [问题反馈](https://github.com/1186258278/OpenCodeChineseTranslation/issues)
- [贡献指南](CONTRIBUTING.md)
